<p-toast></p-toast>
<p-panel [toggleable]="false" [style]="{'font-size':'12px'}" header="Edit Organisation Profile" *ngIf="isDataAvailable">

    <div class="p-grid p-nogutter p-justify-between" *ngIf="npoProfile.createdUser && npoProfile.updatedUser">
        <div>
            <span class="ui-panel-title text-uppercase text-muted" style="font-size:10px;display:inline-block;margin-top:2px;font-weight: bold;height: 20px;">Created By: {{npoProfile.createdUser.fullName}}</span>
                <i style="vertical-align: middle; padding: 10px;"></i>
            <span class="ui-panel-title text-uppercase text-muted" style="font-size:10px;display:inline-block;margin-top:2px;font-weight: bold;height: 20px;">Created Date: {{npoProfile.createdDateTime | date:"yyyy-MM-dd HH:mm:ss"}}</span>
        </div>
        <div>
            <span class="ui-panel-title text-uppercase text-muted" style="font-size:10px;display:inline-block;margin-top:2px;font-weight: bold;height: 20px;">Updated By: {{npoProfile.updatedUser.fullName}}</span>
                <i style="vertical-align: middle; padding: 10px;"></i>
            <span class="ui-panel-title text-uppercase text-muted" style="font-size:10px;display:inline-block;margin-top:2px;font-weight: bold;height: 20px;">Updated Date: {{npoProfile.updatedDateTime | date:"yyyy-MM-dd HH:mm:ss"}}</span>
        </div>
    </div>
    <div style="height: 10px;"></div>

    <p-menubar [model]="menuActions" [style]="{'font-size':'14px', 'height': '43px'}" *ngIf="IsAuthorized(PermissionsEnum.ShowProfileActions)"></p-menubar>
    <p-messages [(value)]="validationErrors" [closable]="false" [enableService]="false"></p-messages>
    <div style="height: 10px;"></div>
    <app-view-npo
        [npoId]="npoProfile.npoId"
        (retrievedNpo)="updateNpo($event)">
    </app-view-npo>
    <div style="height: 10px;"></div>
    <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Address Information" *ngIf="npoProfile">
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="non-mandatory-content">Physical Address Lookup</span>
                </div>
            </div>
            <div class="p-col">
                <p-autoComplete [(ngModel)]="physicalAddressLookup" [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}" [suggestions]="newAddress" (completeMethod)="filterCountrySingle($event)" field="text" [size]="20" placeholder="Find Address (type 4 letters)" [minLength]="4" [forceSelection]="true" [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" (onSelect)="populateAddressField($event, 'physicalAddress')"></p-autoComplete>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Physical Address </span>
                </div>
            </div>
            <div class="p-col">
                <input type="text" class="form-text" pInputText [(ngModel)]="npoProfile.addressInformation.physicalAddress" [ngModelOptions]="{standalone: true}" #physicalAddress="ngModel" [ngClass]="{'ng-dirty': (physicalAddress.invalid && validated) || (physicalAddress.dirty && physicalAddress.invalid)}" required> 
                <small *ngIf="(physicalAddress.invalid && validated) || (physicalAddress.dirty && physicalAddress.invalid)" class="p-error">Physical Address is required.</small>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Is Postal Address same as Physical Address?</span>
                </div>
            </div>
            <div class="p-col">
                <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value" [style]="{'font-size': '12px'}" [(ngModel)]="npoProfile.addressInformation.postalSameAsPhysical" [ngModelOptions]="{standalone: true}" (onChange)="updatePostalAddress($event)" #postalSameAsPhysical="ngModel" [ngClass]="{'ng-dirty': (postalSameAsPhysical.invalid && validated) || (postalSameAsPhysical.dirty && postalSameAsPhysical.invalid)}" required></p-selectButton>
                <small *ngIf="(postalSameAsPhysical.invalid && validated) || (postalSameAsPhysical.dirty && postalSameAsPhysical.invalid)" class="p-error">Is Postal Address same as Physical Address is required.</small>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="non-mandatory-content">Postal Address Lookup</span>
                </div>
            </div>
            <div class="p-col">
                <p-autoComplete [(ngModel)]="postalAddressLookup" [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}" [suggestions]="newAddress" (completeMethod)="filterCountrySingle($event)" field="text" [size]="20" placeholder="Find Address (type 4 letters)" [minLength]="4" [forceSelection]="true" [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" (onSelect)="populateAddressField($event, 'postalAddress')"></p-autoComplete>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Postal Address</span>
                </div>
            </div>
            <div class="p-col">
                <input type="text" class="form-text" pInputText [(ngModel)]="npoProfile.addressInformation.postalAddress" [ngModelOptions]="{standalone: true}" #postalAddress="ngModel" [ngClass]="{'ng-dirty': (postalAddress.invalid && validated) || (postalAddress.dirty && postalAddress.invalid)}" required> 
                <small *ngIf="(postalAddress.invalid && validated) || (postalAddress.dirty && postalAddress.invalid)" class="p-error">Postal Address is required.</small>
            </div>
        </div>
    </p-panel>
    <div style="height: 10px;"></div>
    <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Auditor / Registered Accountant Information">
        <p-table [rowHover]="true" [columns]="auditorCols" [value]="auditorOrAffiliations" *ngIf="auditorOrAffiliations" styleClass="p-datatable-sm">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                        {{col.header}}
                    </th>
                    <th style="width: 7%;">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr class="default-font">
                    <td>{{rowData.organisationName}}</td>
                    <td>{{rowData.registrationNumber}}</td>
                    <td>{{rowData.address}}</td>
                    <td>{{rowData.telephoneNumber}}</td>
                    <td>{{rowData.emailAddress}}</td>
                    <td style="text-align: center;">
                        <button pButton pRipple type="button" class="p-button-text action-button" icon="fa fa-pencil-square-o" (click)="editAuditorInformation(rowData)" pTooltip="Edit" tooltipPosition="top"></button>
                        <button pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="deleteAuditorInformation(rowData)" pTooltip="Delete" tooltipPosition="top"></button>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr class="default-font">
                    <td colspan="6" style="text-align: center;">No results found</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <div style="text-align:left">
                    <button pButton pRipple type="button" label="Add Auditor / Registered Accountant Information" class="p-button-text" icon="fa fa-plus" (click)="addAuditorInformation()"></button>
                </div>
            </ng-template>
        </p-table>
    </p-panel>
    <div style="height: 10px;"></div>
    <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Profile of Staff Members" *ngIf="npoProfile">
        <p-table [rowHover]="true" [value]="staffMemberProfiles" *ngIf="staffMemberProfiles" styleClass="p-datatable-sm">
            <ng-template pTemplate="header">
                <tr>
                    <th rowspan="3">Categories of staff members</th>
                    <th rowspan="3">Number of Vacant Posts</th>
                    <th rowspan="3">Number of Filled Posts</th>
                    <th rowspan="3">Number of Consultants appointed</th>
                    <th rowspan="3">Number of Staff with disabilities</th>
                    <th colspan="8" style="text-align: center;">Representivity</th>
                </tr>
                <tr>
                    <th colspan="2" style="text-align: center;">African</th>
                    <th colspan="2" style="text-align: center;">Indian</th>
                    <th colspan="2" style="text-align: center;">Coloured</th>
                    <th colspan="2" style="text-align: center;">White</th>
                </tr>
                <tr>
                    <th>No. of Male(s)</th>
                    <th>No. of Female(s)</th>
                    <th>No. of Male(s)</th>
                    <th>No. of Female(s)</th>
                    <th>No. of Male(s)</th>
                    <th>No. of Female(s)</th>
                    <th>No. of Male(s)</th>
                    <th>No. of Female(s)</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData>
                <tr>
                    <td *ngIf="rowData.staffCategory && rowData.staffCategory.id !== StaffCategoryEnum.Other">{{rowData.staffCategory.name}}</td>
                    <td *ngIf="rowData.staffCategory && rowData.staffCategory.id === StaffCategoryEnum.Other" pEditableColumn>
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <input type="text" class="form-text" pInputText [(ngModel)]="rowData.otherSpecify" [ngModelOptions]="{standalone: true}" (change)="updateStaffMemberProfile(rowData)" placeholder="Other (Please specify)">
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.otherSpecify}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.vacantPosts" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.vacantPosts}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.filledPosts" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.filledPosts}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.consultantsAppointed" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.consultantsAppointed}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.staffWithDisabilities" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.staffWithDisabilities}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.africanMale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.africanMale}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.africanFemale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.africanFemale}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.indianMale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.indianMale}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.indianFemale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.indianFemale}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.colouredMale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.colouredMale}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.colouredFemale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.colouredFemale}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.whiteMale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.whiteMale}}</ng-template>
                        </p-cellEditor>
                    </td>
                    <td pEditableColumn style="text-align: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <p-inputNumber [(ngModel)]="rowData.whiteFemale" inputId="integeronly" (onBlur)="updateStaffMemberProfile(rowData)" [inputStyle]="{'width':'100%', 'text-align':'center'}"></p-inputNumber>
                            </ng-template>
                            <ng-template pTemplate="output">{{rowData.whiteFemale}}</ng-template>
                        </p-cellEditor>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="footer">
                <tr>
                    <td><span style="font-weight: bold;">Total</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.vacantPosts}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.filledPosts}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.consultantsAppointed}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.staffWithDisabilities}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.africanMale}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.africanFemale}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.indianMale}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.indianFemale}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.colouredMale}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.colouredFemale}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.whiteMale}}</span></td>
                    <td style="text-align: center;"><span style="font-weight: bold;">{{totalStaffMemberProfile.whiteFemale}}</span></td>
                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <div style="text-align:left">
                    <button pButton pRipple type="button" label="Add Other" class="p-button-text" icon="fa fa-plus" (click)="addOther()"></button>
                </div>
            </ng-template>
        </p-table>
    </p-panel>
    <div style="height: 10px;"></div>
    <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Services Rendered">
        <p-table>
            <ng-template pTemplate="header">
                <tr>                   
                    <th style="color: rgb(248, 10, 10);">To add or amend Programme Bank Details, Service Delivery Area(s) and Contact Details, click on the relevant Programme Name below.</th>
                </tr>
            </ng-template>
        </p-table>
        <p-table [rowHover]="true" [columns]="serviceRenderedCols" [value]="servicesRendered" styleClass="p-datatable-sm">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                        {{col.header}}
                    </th>
                    <th style="width: 7%;">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex">
                <tr class="default-font" [ngClass]="{'selected-row': selectedRowIndex === rowIndex}">
                  <td (click)="onFirstTdClick(rowIndex); toggleBankingDetailsPanel(rowData.programme,rowData.subProgramme,rowData.subProgrammeType)">{{rowData.programme.name}}</td>
                  <td>{{rowData.subProgramme.name}}</td>
                  <td>{{rowData.subProgrammeType.name}}</td>
                  <td style="text-align: center;">
                    <button *ngIf="canEditServicesRendered(rowData.programme)" pButton pRipple type="button" class="p-button-text action-button" icon="fa fa-pencil-square-o" (click)="editServicesRendered(rowData)" pTooltip="Edit" tooltipPosition="top"></button>
                    <button *ngIf="canEditServicesRendered(rowData.programme)" pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="deleteServicesRendered(rowData)" pTooltip="Delete" tooltipPosition="top"></button>
                  </td>
                </tr>
              </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr class="default-font">
                    <td colspan="6" style="text-align: center;">No results found</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <div style="text-align:left">
                    <button pButton pRipple type="button" label="Add Services Rendered" class="p-button-text" icon="fa fa-plus" (click)="addServicesRendered()"></button>
                </div>
            </ng-template>
        </p-table>
    </p-panel>
    <div style="height: 10px;"></div>
    <div style="height: 10px;"></div>
    <p-panel [header]="'Banking Details, Service delivery and Contact Information - ' + (selectedProgram ? selectedProgram.name : '')" [style]="{'font-size':'12px'}" *ngIf="displayBankingDetailsPanel && selectedProgram">
        <p-table [value]="programBankDetails" styleClass="p-datatable-sm">
          <ng-template pTemplate="header">
            <tr>
              <th>Bank Name</th>
              <th>Account Number</th>
              <th>Branch</th>
              <th>Account Type</th>
              <th style="width: 7%;">Actions</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-detail>
            <tr>
              <td>{{detail?.bank?.name}}</td>
              <td>{{detail?.accountNumber}}</td>
              <td>{{detail?.branch?.name}}</td>
              <td>{{detail?.accountType?.name}}</td>
              <td style="text-align: center;">
                <button *ngIf="canEdit()"  pButton pRipple type="button" class="p-button-text action-button" icon="fa fa-pencil-square-o" (click)="editProgrammeBankDetail(detail)" pTooltip="Edit" tooltipPosition="top"></button>
                <button *ngIf="canEdit()" pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="deleteProgrammeBankDetail(detail)" pTooltip="Delete" tooltipPosition="top"></button>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="summary" let-rowData>
            <div style="text-align:left">
                <button *ngIf="canEdit()" pButton pRipple type="button" label="Add Banking Details" class="p-button-text" icon="fa fa-plus" (click)="addProgrammeBankDetail()"></button>
            </div>
        </ng-template>
        </p-table>
        <div style="height: 10px;"></div>
        <p-panel [header]="'Contact Details'">  
            <p-table [value]="programContactInformation" styleClass="p-datatable-sm">
                <ng-template pTemplate="header">
                  <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <!-- <th>Status</th> -->
                    <th style="width: 7%;">Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-contact>
                  <tr>
                    <td>{{contact.firstName}}</td>
                    <td>{{contact.lastName}}</td>
                    <td>{{contact.emailAddress}}</td>
                    <td>{{contact.cellphone}}</td>
                    <!-- <td>{{contact?.approvalStatus?.name}}</td> -->
                    <td style="text-align: center;">
                      <button *ngIf="canEdit()" pButton pRipple type="button" class="p-button-text action-button" icon="fa fa-pencil-square-o" (click)="editProgramContactInformation(contact)" pTooltip="Edit" tooltipPosition="top"></button>
                      <button *ngIf="canEdit()" pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="deleteProgramContactInformation(contact)" pTooltip="Delete" tooltipPosition="top"></button>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="summary" let-rowData>
                    <div style="text-align:left">
                        <button *ngIf="canEdit()" pButton pRipple type="button" label="Add Contact Details" class="p-button-text" icon="fa fa-plus" (click)="addContactInformation()"></button>
                    </div>
                </ng-template>
              </p-table> 
          </p-panel>

          <div style="height: 10px;"></div>
          <p-panel [header]="'Service Delivery Areas'">
            <p-table [value]="programDeliveryDetails" styleClass="p-datatable-sm">
              <ng-template pTemplate="header">
                <tr>
                  <th>Region</th>
                  <th>District Council</th>
                  <th>Local Municipality</th>
                  <th>Service delivery address</th>
                  <!-- <th>Status</th> -->
                  <th style="width: 7%;">Actions</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-delivery>
                <tr>
                  <td>{{getNames(delivery?.regions)}}</td>
                  <td>{{delivery.districtCouncil?.name}}</td>
                  <td>{{delivery.localMunicipality?.name}}</td>
                  <td>{{getNames(delivery?.serviceDeliveryAreas)}}</td>
                  <!-- <td>{{delivery?.approvalStatus?.name}}</td> -->
                  <td style="text-align: center;">
                    <button *ngIf="canEdit()" pButton pRipple type="button" class="p-button-text action-button" icon="fa fa-pencil-square-o" (click)="editProgrammeServiceDelivery(delivery)" pTooltip="Edit" tooltipPosition="top"></button>
                    <button *ngIf="canEdit()" pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="deleteProgrammeServiceDelivery(delivery)" pTooltip="Delete" tooltipPosition="top"></button>
                  </td>
                </tr>
              </ng-template>
              <ng-template pTemplate="summary" let-rowData>
                <div style="text-align:left">
                  <button *ngIf="canEdit()" pButton pRipple type="button" label="Add Service Delivery" class="p-button-text" icon="fa fa-plus" (click)="addProgrammeServiceDelivery()"></button>
                </div>
              </ng-template>
            </p-table>
          </p-panel>
          
        <!-- <p-message *ngIf="!programContactInformation || !programContactInformation.length" severity="info" text="No contact details available."></p-message> -->
    </p-panel>
    <div style="height: 10px;"></div>

    <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Facility and/or Community Place Information">
        <p-table [rowHover]="true" [columns]="facilityInfoCols" [value]="npoProfileFacilityLists" *ngIf="npoProfileFacilityLists" styleClass="p-datatable-sm">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                        {{col.header}}
                    </th>
                    <th style="width: 7%;">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex">
                <tr class="heading">
                    <td *ngIf="rowGroupMetadata[rowIndex].itemExists === false" [attr.colspan]="5">
                        <span class="p-text-bold">{{rowData.facilityList.facilityType.name}}</span>
                    </td>
                </tr>
                <tr class="default-font">                    
                    <td>{{rowData.facilityList.facilitySubDistrict.name}}</td>
                    <td>{{rowData.facilityList.name}}</td>
                    <td>{{rowData.facilityList.facilityClass.name}}</td>
                    <td>{{rowData.facilityList.address}}</td>
                    <td style="text-align: center;">
                        <button pButton pRipple type="button" class="p-button-text action-button" icon="fa fa-pencil-square-o" (click)="editFacilityInformation(rowData)" pTooltip="Edit" tooltipPosition="top"></button>
                        <button pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="deleteFacilityInformation(rowData)" pTooltip="Delete" tooltipPosition="top"></button>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr class="default-font">
                    <td colspan="5" style="text-align: center;">No results found</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <div style="text-align:left">
                    <button pButton pRipple type="button" label="Add Facility or Community Place Information" class="p-button-text" icon="fa fa-plus" (click)="addFacilityInformation()"></button>
                </div>
            </ng-template>
        </p-table>
    </p-panel>
    <div style="height: 10px;"></div>
    <!-- <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Linked Organisation(s)">
        <p-table [rowHover]="true" [columns]="organisationCols" [value]="organisations" *ngIf="organisations" styleClass="p-datatable-sm">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                        {{col.header}}
                    </th>
                    <th style="width: 5%;">Actions</th>
                </tr>
            </ng-template>
        </p-table>
    </p-panel>
    <div style="height: 10px;"></div> -->
    <!-- <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Bank Details">
        <p-table [rowHover]="true" [columns]="bankDetailCols" [value]="bankDetails" styleClass="p-datatable-sm">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                        {{col.header}}
                    </th>
                    <th style="width: 7%;">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr class="default-font">
                    <td *ngIf="rowData.bank">{{rowData.bank.name}}</td>
                    <td *ngIf="rowData.branch">{{rowData.branch.name}}</td>
                    <td>{{rowData.branchCode}}</td>
                    <td *ngIf="rowData.accountType">{{rowData.accountType.name}}</td>
                    <td>{{rowData.accountNumber}}</td>
                    <td style="text-align: center;">
                        <button pButton pRipple type="button" class="p-button-text action-button" icon="fa fa-pencil-square-o" (click)="editBankDetail(rowData)" pTooltip="Edit" tooltipPosition="top"></button>
                        <button pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="deleteBankDetail(rowData)" pTooltip="Delete" tooltipPosition="top"></button>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr class="default-font">
                    <td colspan="6" style="text-align: center;">No results found</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="summary" let-rowData>
                <div style="text-align:left">
                    <button pButton pRipple type="button" label="Add Bank Detail" class="p-button-text" icon="fa fa-plus" (click)="addBankDetail()"></button>
                </div>
            </ng-template>
        </p-table>
    </p-panel>    
    <div style="height: 10px;"></div> -->
    <p-panel [toggleable]="true" [style]="{'font-size':'12px'}" header="Supporting Documents">
        <p-fileUpload name="demo[]" #form customUpload="true" (uploadHandler)="onUploadChange($event, form)" [showCancelButton]="false" chooseLabel="Browse">
            <ng-template let-file pTemplate="file">
                <div style="height: 10px;"></div>
                <div class="p-grid">
                    <div class="p-col-5">
                        <div>{{file.name}}</div>
                    </div>
                    <div class="p-col-5">
                        <div>
                            <p-dropdown [options]="documentTypes" placeholder="Select a Document Type" optionLabel="name" [(ngModel)]="file.documentType" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body"></p-dropdown>
                        </div>
                    </div>
                    <div class="p-col-2">
                        <div class="pull-right">
                            <button pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="remove($event, file, form)" pTooltip="Delete" tooltipPosition="top"></button>
                        </div>
                    </div>
                </div>
            </ng-template>
            <ng-template pTemplate="content">
                <div style="height: 10px;"></div>
                <p-table [rowHover]="true" [value]="documents" *ngIf="documents" styleClass="p-datatable-sm" [columns]="documentCols">
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                                {{col.header}}
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-document let-rowIndex="rowIndex">
                        <tr class="default-font"> 
                            <td style="text-align: center;">{{rowIndex + 1}}</td>
                            <td>{{document.name}}</td>
                            <td>{{document.documentType.name}}</td>
                            <td>{{document.fileSize}}</td>
                            <td>{{document.createdDateTime | date: 'yyyy-MM-dd'}}</td>
                            <td style="text-align: center;">
                                <button pButton pRipple type="button" class="p-button-text p-button-success action-button" icon="fa fa-cloud-download" (click)="onDownloadDocument(document)" pTooltip="Download" tooltipPosition="top"></button>
                                <button pButton pRipple type="button" class="p-button-text p-button-danger action-button" icon="fa fa-trash" (click)="onDeleteDocument(document)" pTooltip="Delete" tooltipPosition="top"></button>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr class="default-font">
                            <td colspan="6" style="text-align: center;">There are no documents uploaded.</td>
                        </tr>
                    </ng-template>
                </p-table>
                <div *ngIf="compulsoryDocuments.length > 0">
                    <div style="height: 20px;"></div>
                    <div class="heading">Compulsory Documents</div>
                    <p-table [rowHover]="true" [value]="compulsoryDocuments" *ngIf="compulsoryDocuments" styleClass="p-datatable-sm" [columns]="documentTypeCols">
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                                    {{col.header}}
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex">
                            <tr class="default-font"> 
                                <td style="text-align: center;">{{rowIndex + 1}}</td>
                                <td>{{rowData.name}}</td>
                                <td>{{rowData.description}}</td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr class="default-font">
                                <td colspan="3" style="text-align: center;">No results found.</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
                <div *ngIf="nonCompulsoryDocuments.length > 0">
                    <div style="height: 20px;"></div>
                    <div class="heading">Non-Compulsory Documents</div>
                    <p-table [rowHover]="true" [value]="nonCompulsoryDocuments" *ngIf="nonCompulsoryDocuments" styleClass="p-datatable-sm" [columns]="documentTypeCols">
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" [ngStyle]="{'width': col.width}">
                                    {{col.header}}
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex">
                            <tr class="default-font"> 
                                <td style="text-align: center;">{{rowIndex + 1}}</td>
                                <td>{{rowData.name}}</td>
                                <td>{{rowData.description}}</td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr class="default-font">
                                <td colspan="3" style="text-align: center;">No results found.</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </ng-template>
        </p-fileUpload>
    </p-panel>
    <div style="height: 10px;"></div>
    <p-menubar [model]="menuActions" [style]="{'font-size':'14px', 'height': '43px'}" *ngIf="IsAuthorized(PermissionsEnum.ShowProfileActions)"></p-menubar>
</p-panel>

<p-dialog header="Facility or Community Place Information" 
          [(visible)]="displayFacilityInformationDialog" 
          [style]="{width: '50vw'}" 
          [focusOnShow]="false"
          showEffect="fade"
          [transitionOptions]="'0ms'"
          [modal]="true">
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Type</span>
            </div>
        </div>
        <div class="p-col">
            <p-dropdown [options]="facilityTypes" placeholder="Select a Type" optionLabel="name" [(ngModel)]="selectedFacilityType" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" (onChange)="facilityTypeChange($event.value)" [disabled]="!newFacilityInformation"></p-dropdown>
        </div>
    </div>
    <div *ngIf="selectedFacilityType">            
        <div *ngIf="selectedFacilityType.id == FacilityTypeEnum.Facility">
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="mandatory-content">Facility Lookup</span>
                    </div>
                </div>
                <div class="p-col" *ngIf="newFacilityInformation">
                    <p-autoComplete appendTo="body" id="selectedDenodoFacility"                      
                        [(ngModel)]="selectedDenodoFacility"
                        [style]="{'width':'100%'}"
                        [inputStyle]="{'width':'100%'}"
                        [suggestions]="facilityLists"
                        field="name"
                        (completeMethod)="search($event)"
                        [size]="20"
                        placeholder="Find Facility (type 4 letters)"
                        [forceSelection]="true"
                        [minLength]="4"
                        [showTransitionOptions]="'0ms'"
                        [hideTransitionOptions]="'0ms'"
                        emptyMessage="No results found"
                        name="facility"
                        [showEmptyMessage]="true"
                        (onSelect)="selectDenodoFacility($event, true)">
                    </p-autoComplete>
                </div>
                <div class="p-col" *ngIf="mapping.facilityList && isFacilityInformationEdit">
                    <input type="text" class="form-text" pInputText [(ngModel)]="mapping.facilityList.name" [ngModelOptions]="{standalone: true}" [disabled]="disableField">
                </div>
            </div>
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="mandatory-content">Facility found?</span>
                    </div>
                </div>
                <div class="p-col" *ngIf="mapping.facilityList">
                    <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value" [style]="{'font-size': '12px'}" [(ngModel)]="mapping.facilityList.facilityFound" [ngModelOptions]="{standalone: true}" (onChange)="facilityFoundChange($event.value)" [disabled]="!newFacilityInformation"></p-selectButton>
                </div>
            </div>
            <div *ngIf="mapping.facilityList.facilityFound == false">
                <div class="p-grid">
                    <div class="p-col-fixed form-label">
                        <div class="box">
                            <span class="mandatory-content">Facility Name</span>
                        </div>
                    </div>
                    <div class="p-col" *ngIf="mapping.facilityList">
                        <input type="text" class="form-text" pInputText [(ngModel)]="mapping.facilityList.name" [ngModelOptions]="{standalone: true}" [disabled]="disableField">
                    </div>
                </div>
                <div class="p-grid">
                    <div class="p-col-fixed form-label">
                        <div class="box">
                            <span class="mandatory-content">District</span>
                        </div>
                    </div>
                    <div class="p-col">
                        <p-dropdown [options]="facilityDistricts" placeholder="Select a District" optionLabel="name" [(ngModel)]="selectedDistrict" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" (onChange)="districtChange($event.value)" [disabled]="disableField"></p-dropdown>
                    </div>
                </div>
                <div class="p-grid">
                    <div class="p-col-fixed form-label">
                        <div class="box">
                            <span class="mandatory-content">Sub-District</span>
                        </div>
                    </div>
                    <div class="p-col">
                        <p-dropdown [options]="facilitySubDistricts" placeholder="Select a Sub-District" optionLabel="name" [(ngModel)]="selectedSubDistrict" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" [disabled]="disableField"></p-dropdown>
                    </div>
                </div>
                <div class="p-grid">
                    <div class="p-col-fixed form-label">
                        <div class="box">
                            <span class="mandatory-content">Class</span>
                        </div>
                    </div>
                    <div class="p-col">
                        <p-dropdown [options]="facilityClasses" placeholder="Select a Class" optionLabel="name" [(ngModel)]="selectedClass" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" [filter]="true" filterBy="name" [disabled]="disableField"></p-dropdown>
                    </div>
                </div>
                <div class="p-grid">
                    <div class="p-col-fixed form-label">
                        <div class="box">
                            <span class="non-mandatory-content">Address Lookup</span>
                        </div>
                    </div>
                    <div class="p-col">
                        <p-autoComplete [(ngModel)]="addressLookup" [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}" [suggestions]="newAddress" (completeMethod)="filterCountrySingle($event)" field="text" [size]="20" placeholder="Find Address (type 4 letters)" [minLength]="4" [forceSelection]="true" [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" appendTo="body" [disabled]="disableField" (onSelect)="populateAddressField($event, 'facilityAddress')"></p-autoComplete>
                    </div>
                </div>
                <div class="p-grid">
                    <div class="p-col-fixed form-label">
                        <div class="box">
                            <span class="mandatory-content">Address</span>
                        </div>
                    </div>
                    <div class="p-col">
                        <input type="text" class="form-text" pInputText [(ngModel)]="mapping.facilityList.address" [ngModelOptions]="{standalone: true}"> 
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="selectedFacilityType.id == FacilityTypeEnum.Community">
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="mandatory-content">Community Place Name</span>
                    </div>
                </div>
                <div class="p-col" *ngIf="mapping.facilityList">
                    <input type="text" class="form-text" pInputText [(ngModel)]="mapping.facilityList.name" [ngModelOptions]="{standalone: true}">
                </div>
            </div>
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="mandatory-content">District</span>
                    </div>
                </div>
                <div class="p-col">
                    <p-dropdown [options]="facilityDistricts" placeholder="Select a District" optionLabel="name" [(ngModel)]="selectedDistrict" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" (onChange)="districtChange($event.value)"></p-dropdown>
                </div>
            </div>
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="mandatory-content">Sub-District</span>
                    </div>
                </div>
                <div class="p-col">
                    <p-dropdown [options]="facilitySubDistricts" placeholder="Select a Sub-District" optionLabel="name" [(ngModel)]="selectedSubDistrict" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body"></p-dropdown>
                </div>
            </div>
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="non-mandatory-content">Class</span>
                    </div>
                </div>
                <div class="p-col">
                    <p-dropdown [options]="facilityClasses" placeholder="Select a Class" optionLabel="name" [(ngModel)]="selectedClass" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" [filter]="true" filterBy="name"></p-dropdown>
                </div>
            </div>
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="non-mandatory-content">Address Lookup</span>
                    </div>
                </div>
                <div class="p-col">
                    <p-autoComplete [(ngModel)]="addressLookup" [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}" [suggestions]="newAddress" (completeMethod)="filterCountrySingle($event)" field="text" [size]="20" placeholder="Find Address (type 4 letters)" [minLength]="4" [forceSelection]="true" [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" appendTo="body" (onSelect)="populateAddressField($event, 'facilityAddress')"></p-autoComplete>
                </div>
            </div>
            <div class="p-grid">
                <div class="p-col-fixed form-label">
                    <div class="box">
                        <span class="non-mandatory-content">Address</span>
                    </div>
                </div>
                <div class="p-col">
                    <!-- <p-autoComplete [(ngModel)]="addressLookup" [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}" [suggestions]="newAddress" (completeMethod)="filterCountrySingle($event)" field="text" [size]="20" placeholder="Find Address (type 4 letters)" [minLength]="4" [forceSelection]="true" [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" appendTo="body"></p-autoComplete> -->
                    <input type="text" class="form-text" pInputText [(ngModel)]="mapping.facilityList.address" [ngModelOptions]="{standalone: true}"> 
                </div>
            </div>
        </div>
    </div>
    <ng-template pTemplate="footer">
        <button pButton pRipple type="button" label="Save" class="p-button-text" icon="fa fa-floppy-o" [disabled]=disableSaveFacilityInformation() (click)="saveFacilityInformation()"></button>
    </ng-template>
</p-dialog>

<p-dialog header="Services Rendered" 
          [(visible)]="displayServiceRenderedDialog" 
          [style]="{width: '50vw'}" 
          [focusOnShow]="false"
          showEffect="fade"
          [transitionOptions]="'0ms'"
          [modal]="true">

        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Department</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown [options]="departments1" 
                placeholder="Select a Department" optionLabel="name"
                 [(ngModel)]="selectedDepartment" [ngModelOptions]="{standalone: true}" 
                 [style]="{'width':'100%'}" appendTo="body"  
                 (onChange)="loadDepartmentPrograms($event.value.id)" [filter]="true" filterBy="name"></p-dropdown>
            </div>
        </div>
    
        
        <div class="p-grid">
            <div class="p-col-fixed form-label">
              <div class="box">
                <span class="mandatory-content">Programme</span>
              </div>
            </div>
            <div class="p-col">
              <p-dropdown 
                [options]="filteredProgrammes" 
                placeholder="Select a Programme" 
                optionLabel="name" 
                [(ngModel)]="selectedProgramme" 
                [ngModelOptions]="{standalone: true}" 
                [style]="{'width':'100%'}" 
                appendTo="body" 
                (onChange)="programmeChange($event.value)" 
                [filter]="true" 
                filterBy="name">
              </p-dropdown>
            </div>
        </div>

        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Sub-Programme</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown [options]="filteredSubProgrammes" placeholder="Select a Sub-Programme" optionLabel="name" 
                [(ngModel)]="selectedSubProgramme" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" 
                appendTo="body" (onChange)="subProgrammeChange($event.value)" [disabled]="disableSubProgramme()"></p-dropdown>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Sub-Programme Type</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown [options]="filteredSubProgrammeTypes" placeholder="Select a Sub-Programme Type" optionLabel="name"
                 [(ngModel)]="selectedSubProgrammeType" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}"
                  appendTo="body" [disabled]="disableSubProgrammeType()"></p-dropdown>
            </div>
        </div>

        <!-- <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Sub-Programme</span>
                </div>
            </div>
            <div class="p-col">
                <p-multiSelect 
                    [options]="filteredSubProgrammes"
                    placeholder="Select a Sub-Programme"
                    optionLabel="name"
                    [(ngModel)]="selectedServiceSubProgrammes"
                    [ngModelOptions]="{standalone: true}"
                    [style]="{'width':'100%'}"
                    appendTo="body"
                    (onChange)="subProgrammeChange1($event)"
                    [disabled]="disableSubProgramme()"
                    defaultLabel="Select Sub-Programme(s)"
                    selectedItemsLabel="{0} items selected">
                </p-multiSelect>
            </div> 
        </div> -->
        <!-- <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Sub-Programme Type</span>
                </div>
            </div>
            <div class="p-col">
                <p-multiSelect 
                    [options]="filteredSubProgrammeTypes"
                    placeholder="Select a Sub-Programme Type"
                    optionLabel="name"
                    [(ngModel)]="selectedServiceSubProgrammeTypes"
                    [ngModelOptions]="{standalone: true}"
                    [style]="{'width':'100%'}"
                    appendTo="body"
                    [disabled]="disableSubProgrammeType()"
                    defaultLabel="Select Sub-Programme Type(s)"
                    selectedItemsLabel="{0} items selected">
                </p-multiSelect>
            </div>
            
        </div> -->
        <ng-template pTemplate="footer">
            <button pButton pRipple type="button" label="Save" class="p-button-text" icon="fa fa-floppy-o" [disabled]=disableSaveServicesRendered() (click)="saveServicesRendered()"></button>
        </ng-template>
</p-dialog>

<p-dialog header="Bank Detail" 
          [(visible)]="displayBankDetailDialog" 
          [style]="{width: '50vw'}" 
          [focusOnShow]="false"
          showEffect="fade"
          [transitionOptions]="'0ms'"
          [modal]="true">
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Bank</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown [options]="banks" placeholder="Select a Bank" optionLabel="name" [(ngModel)]="selectedBank" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" (onChange)="bankChange()" [filter]="true" filterBy="name"></p-dropdown>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Branch</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown [options]="branches" placeholder="Select a branch" optionLabel="name" [(ngModel)]="selectedBranch" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" (onChange)="branchChange()" [filter]="true" filterBy="name"></p-dropdown>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="non-mandatory-content">Branch Code</span>
                </div>
            </div>
            <div class="p-col">
                <input type="text" name="branchCode" class="form-text" pInputText [(ngModel)]="bankDetail.branchCode" [ngModelOptions]="{standalone: true}" [disabled]="true"> 
            </div>
        </div>        
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Account Type</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown [options]="accountTypes" placeholder="Select an Account Type" optionLabel="name" [(ngModel)]="selectedAccountType" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body"></p-dropdown>
            </div>
        </div>        
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Account Number</span>
                </div>
            </div>
            <div class="p-col">
                <input type="text" name="accountNumber" class="form-text" pInputText [(ngModel)]="bankDetail.accountNumber" [ngModelOptions]="{standalone: true}" (keypress)="numberOnly($event)"> 
            </div>
        </div>
        <ng-template pTemplate="footer">
            <button pButton pRipple type="button" label="Save" class="p-button-text" icon="fa fa-floppy-o" [disabled]=disableSaveBankDetail() (click)="saveBankDetail()"></button>
        </ng-template>
</p-dialog>

<p-dialog header="Auditor / Registered Accountant Information" 
          [(visible)]="displayAuditorDialog" 
          [style]="{width: '50vw'}" 
          [focusOnShow]="false"
          showEffect="fade"
          [transitionOptions]="'0ms'"
          [modal]="true">
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Company</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="auditorOrAffiliation.organisationName" [ngModelOptions]="{standalone: true}">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Registration Number</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="auditorOrAffiliation.registrationNumber" [ngModelOptions]="{standalone: true}">
        </div>
    </div>    
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Address Lookup</span>
            </div>
        </div>
        <div class="p-col">
            <p-autoComplete [(ngModel)]="addressLookup" [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}" [suggestions]="newAddress" (completeMethod)="filterCountrySingle($event)" field="text" [size]="20" placeholder="Find Address (type 4 letters)" [minLength]="4" [forceSelection]="true" [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" (onSelect)="populateAddressField($event, 'auditorAddress')"></p-autoComplete>
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Address</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="auditorOrAffiliation.address" [ngModelOptions]="{standalone: true}">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Contact Person</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="auditorOrAffiliation.contactPerson" [ngModelOptions]="{standalone: true}">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Telephone</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="auditorOrAffiliation.telephoneNumber" [ngModelOptions]="{standalone: true}" [minlength]="10" [maxlength]="10" (keypress)="numberOnly($event)">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Email Address</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="auditorOrAffiliation.emailAddress" [ngModelOptions]="{standalone: true}" #auditorEmailAddress="ngModel">
            <div class="md-errors-spacer" [hidden]="auditorEmailAddress.valid || auditorEmailAddress.untouched">
                <small class="text-danger" *ngIf="auditorEmailAddress.errors && auditorEmailAddress.errors.pattern">Please provide a valid email address</small>
            </div>
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Website</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="auditorOrAffiliation.website" [ngModelOptions]="{standalone: true}">
        </div>
    </div>
    <ng-template pTemplate="footer">
        <button pButton pRipple type="button" label="Save" class="p-button-text" icon="fa fa-floppy-o" [disabled]=disableSaveAuditorInfo() (click)="saveAuditorInformation()"></button>
    </ng-template>
</p-dialog>

<p-dialog header="Contact " 
          [(visible)]="displayContactDialog" 
          [style]="{width: '50vw'}" 
          [focusOnShow]="false"
          showEffect="fade"
          [transitionOptions]="'0ms'"
          [modal]="true">
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Title</span>
            </div>
        </div>
        <div class="p-col">
            <p-dropdown [options]="titles" placeholder="Select a Title" optionLabel="name" [(ngModel)]="selectedTitle" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body"></p-dropdown>
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">First Name</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.firstName" [ngModelOptions]="{standalone: true}">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Last Name</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.lastName" [ngModelOptions]="{standalone: true}">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">RSA ID No.</span>
            </div>
        </div>
        <div class="p-col">
            <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value" [style]="{'font-size': '12px'}" [(ngModel)]="contactInformation.rsaIdNumber" [ngModelOptions]="{standalone: true}" (onChange)="clearIdPassportNumber($event)"></p-selectButton>
        </div>
    </div>
    <div class="p-grid" *ngIf="contactInformation.rsaIdNumber === true">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">RSA ID Number</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.idNumber" [ngModelOptions]="{standalone: true}" [minlength]="13" [maxlength]="13" (keypress)="numberOnly($event)">
        </div>
    </div>
    <div class="p-grid" *ngIf="contactInformation.rsaIdNumber === false">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Passport Number</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.passportNumber" [ngModelOptions]="{standalone: true}">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Email</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.emailAddress" [ngModelOptions]="{standalone: true}" #emailAddress="ngModel">
            <div class="md-errors-spacer" [hidden]="emailAddress.valid || emailAddress.untouched">
                <small class="text-danger" *ngIf="emailAddress.errors && emailAddress.errors.pattern">Please provide a valid email address</small>
            </div>
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Telephone</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.telephone" [ngModelOptions]="{standalone: true}" [minlength]="10" [maxlength]="10" (keypress)="numberOnly($event)">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="mandatory-content">Cellphone</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.cellphone" [ngModelOptions]="{standalone: true}" [minlength]="10" [maxlength]="10" (keypress)="numberOnly($event)">
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Position</span>
            </div>
        </div>
        <div class="p-col">
            <p-dropdown [options]="positions" placeholder="Select a Position" optionLabel="name" [(ngModel)]="selectedPosition" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" [filter]="true" filterBy="name" appendTo="body"></p-dropdown>
        </div>
    </div>  
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Race</span>
            </div>
        </div>
        <div class="p-col">
            <p-dropdown [options]="races" placeholder="Select a Race" optionLabel="name" [(ngModel)]="selectedRace" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" [filter]="true" filterBy="name" appendTo="body"></p-dropdown>
        </div>
    </div> 
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Preferred Language</span>
            </div>
        </div>
        <div class="p-col">
            <p-dropdown [options]="languages" placeholder="Select a Preferred Language" optionLabel="name" [(ngModel)]="selectedLanguage" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" [filter]="true" filterBy="name" appendTo="body"></p-dropdown>
        </div>
    </div>     
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Gender</span>
            </div>
        </div>
        <div class="p-col">
            <p-dropdown [options]="gender" placeholder="Select a Gender" optionLabel="name" [(ngModel)]="selectedGender" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" [filter]="true" filterBy="name" appendTo="body"></p-dropdown>
        </div>
    </div>  
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Qualifications</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.qualifications" [ngModelOptions]="{standalone: true}">
        </div>
    </div>  
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Physical Address</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.addressInformation" [ngModelOptions]="{standalone: true}">
        </div>
    </div>    
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Years of Experience</span>
            </div>
        </div>
        <div class="p-col">
            <input type="text" class="form-text" pInputText [(ngModel)]="contactInformation.yearsOfExperience" [ngModelOptions]="{standalone: true}" [minlength]="10" [maxlength]="10" (keypress)="numberOnly($event)">
        </div>
    </div>  
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Date of Employment</span>
            </div>
        </div>
        <div class="p-col">
            <p-calendar [minDate]="minDate" [maxDate]="maxDate"  [(ngModel)]="contactInformation.dateOfEmployment" [ngModelOptions]="{standalone: true}" dateFormat="yy-mm-dd" [style]="{'width': '50%'}" inputId="time" appendTo="body"></p-calendar>
        </div>
    </div> 
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Comments</span>
            </div>
        </div>
        <div class="p-col">
            <textarea class="form-text" [rows]="5" [cols]="30" pInputTextarea [(ngModel)]="contactInformation.comments" [ngModelOptions]="{standalone: true}" [maxlength]="1000"></textarea>
        </div>
    </div> 
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Is Primary Contact</span>
            </div>
        </div>
        <div class="p-col">
            <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value" [style]="{'font-size': '12px'}" [(ngModel)]="contactInformation.isPrimaryContact" [ngModelOptions]="{standalone: true}"></p-selectButton>
        </div>
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Is Disabled</span>
            </div>
        </div>
        <div class="p-col">
            <p-checkbox [(ngModel)]="contactInformation.isDisabled" binary="true" inputId="binary"></p-checkbox>
        </div>
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Is Bank Signatory</span>
            </div>
        </div>
        <div class="p-col">
            <p-checkbox [(ngModel)]="contactInformation.isSignatory" binary="true" inputId="binary"></p-checkbox>
        </div>
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Is Written Agreement Signatory</span>
            </div>
        </div>
        <div class="p-col">
            <p-checkbox [(ngModel)]="contactInformation.isWrittenAgreementSignatory" binary="true" inputId="binary"></p-checkbox>
        </div>        
    </div>
    <div class="p-grid">
        <div class="p-col-fixed form-label">
            <div class="box">
                <span class="non-mandatory-content">Is Board Member</span>
            </div>
        </div>
        <div class="p-col">
            <p-checkbox [(ngModel)]="contactInformation.isBoardMember" binary="true" inputId="binary"></p-checkbox>
        </div>
    </div>         

    <ng-template pTemplate="footer">
        <button pButton pRipple type="button" label="Save" class="p-button-text" icon="fa fa-floppy-o" [disabled]=disableProgrammeSaveContactInfo() (click)="saveProgrammeContactInformation()"></button>
    </ng-template>
</p-dialog>


<p-dialog header="Bank Detail" [(visible)]="displayBankDetailDialog" [style]="{width: '50vw'}" [focusOnShow]="false" showEffect="fade" [transitionOptions]="'0ms'" [modal]="true">
    <div class="p-grid">
      <div class="p-col-fixed form-label">
        <div class="box">
          <span class="mandatory-content">Bank</span>
        </div>
      </div>
      <div class="p-col">
        <p-dropdown [options]="banks" placeholder="Select a Bank" optionLabel="name" [(ngModel)]="selectedBank" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" (onChange)="bankChange()" [filter]="true" filterBy="name"></p-dropdown>
      </div>
    </div>
    <div class="p-grid">
      <div class="p-col-fixed form-label">
        <div class="box">
          <span class="mandatory-content">Branch</span>
        </div>
      </div>
      <div class="p-col">
        <p-dropdown [options]="branches" placeholder="Select a branch" optionLabel="name" [(ngModel)]="selectedBranch" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" (onChange)="branchProgrammeChange()" [filter]="true" filterBy="name"></p-dropdown>
      </div>
    </div>
    <div class="p-grid">
      <div class="p-col-fixed form-label">
        <div class="box">
          <span class="non-mandatory-content">Branch Code</span>
        </div>
      </div>
      <div class="p-col">
        <input type="text" name="branchCode" class="form-text" pInputText [(ngModel)]="programBankDetail.branchCode" [ngModelOptions]="{standalone: true}" [disabled]="true"> 
      </div>
    </div>        
    <div class="p-grid">
      <div class="p-col-fixed form-label">
        <div class="box">
          <span class="mandatory-content">Account Type</span>
        </div>
      </div>
      <div class="p-col">
        <p-dropdown [options]="accountTypes" placeholder="Select an Account Type" optionLabel="name" [(ngModel)]="selectedAccountType" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body"></p-dropdown>
      </div>
    </div>        
    <div class="p-grid">
      <div class="p-col-fixed form-label">
        <div class="box">
          <span class="mandatory-content">Account Number</span>
        </div>
      </div>
      <div class="p-col">
        <input type="text" name="accountNumber" class="form-text" pInputText [(ngModel)]="programBankDetail.accountNumber" [ngModelOptions]="{standalone: true}" (keypress)="numberOnly($event)"> 
      </div>
    </div>
    <ng-template pTemplate="footer">
      <button pButton pRipple type="button" label="Save" class="p-button-text" icon="fa fa-floppy-o" [disabled]="disableSaveProgramBankDetail()" (click)="saveProgrammeBankDetail()"></button>
    </ng-template>
</p-dialog>


<p-dialog header="Programme Service Delivery" 
          [(visible)]="displayDeliveryDialog" 
          [style]="{width: '50vw'}" 
          [focusOnShow]="false"
          showEffect="fade"
          [transitionOptions]="'0ms'"
          [modal]="true">

          <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">District Council</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown (onChange)="OnDistrictCouncilChange($event.value)" [options]="allDistrictCouncils" placeholder="Select a District Council" optionLabel="name" [(ngModel)]="selectedDistrictCouncil" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body"></p-dropdown>
            </div>
        </div>
        
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="non-mandatory-content">Local Municipality</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown (onChange)="onLocalMunicipalityChange($event.value)" [options]="localMunicipalities" 
                placeholder="Select a Local Municipality" optionLabel="name" [(ngModel)]="selectedLocalMunicipality" 
                [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body"></p-dropdown>
            </div>
        </div>
    
        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Region</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown defaultLabel="Choose" optionLabel="name" [options]="regions"
                [(ngModel)]="selectedRegions" [ngModelOptions]="{standalone: true}" appendTo="body"
                (onChange)="onRegionChange($event.value)" [style]="{'width':'100%'}"
                ></p-dropdown>
            </div>
        </div>

        <div class="p-grid">
            <div class="p-col-fixed form-label">
                <div class="box">
                    <span class="mandatory-content">Service delivery address</span>
                </div>
            </div>
            <div class="p-col">
                <p-dropdown defaultLabel="Choose" optionLabel="name" [options]="sdas" [(ngModel)]="selectedSdas"
                [filter]="true" filterBy="name"
                [ngModelOptions]="{standalone: true}" appendTo="body" (onChange)="onSdaChange($event.value)"
                [style]="{'width':'100%'}"></p-dropdown>
            </div>
        </div>
        
    <ng-template pTemplate="footer">
        <button pButton pRipple type="button" label="Save" class="p-button-text" icon="fa fa-floppy-o" (click)="saveProgrammeServiceDelivery()" [disabled]="disableProgrammeerviceDeliverySave()"></button>
    </ng-template>
</p-dialog>


<div class="content-section implementation">
    <p-confirmDialog #cd header="Confirmation" [style]="{width: '30vw'}" icon="pi pi-exclamation-triangle">
        <p-footer>
            <button type="button" pButton icon="fa fa-check" class="ui-button-info" label="Yes" (click)="cd.accept()"></button>
            <button type="button" pButton icon="fa fa-times" class="ui-button-info" label="No" (click)="cd.reject()"></button>
        </p-footer>
    </p-confirmDialog>
</div>
