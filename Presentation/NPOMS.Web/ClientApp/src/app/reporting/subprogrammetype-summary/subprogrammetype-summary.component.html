<p-toast></p-toast>
<p-panel [toggleable]="false" [style]="{'font-size':'12px'}" header="Summary">
    <p-menubar [model]="menuActions" [style]="{'font-size':'14px'}"></p-menubar>    
    <div style="height: 10px;"></div>
    <p-panel [style]="{'font-size':'12px'}" header="Summary">
        <p-card [style]="{width: '100%',backgroundColor:'var(--surface-b)'}">
            <div style="margin-top: 0px;" class="p-grid">
                <div class="p-col-6">
                    <div class="p-fluid">
                        <div class="p-grid">
                            <div class="p-col-fixed form-label">
                                <div class="box">
                                    <span class="non-mandatory-content">Service Delivery Area</span>
                                </div>
                            </div>
                            <div class="p-col">
                                <p-dropdown
                                [(ngModel)]="selectedOption"
                                [options]="sdas"
                                placeholder="Select service delivery area"
                                optionLabel="name"
                                (onChange)="onDropdownChange($event)">
                          </p-dropdown>  </div>
                        </div>
                        <div class="p-grid">
                            <div class="p-col-fixed form-label">
                                <div class="box">
                                    <span class="non-mandatory-content">Programme</span>
                                </div>
                            </div>
                            <div class="p-col">
                                <p-dropdown
                                [(ngModel)]="selectedProgramme"
                                [options]="allProgrammes"
                                placeholder="Select programme"
                                optionLabel="name"
                                (onChange)="onProgramDropdownChange($event)">
                          </p-dropdown>  </div>
                        </div>
                        <div class="p-grid">
                            <div class="p-col-fixed form-label">
                                <div class="box">
                                    <span class="mandatory-content">Financial Year</span>
                                </div>
                            </div>
                            <div class="p-col">
                                <p-dropdown [options]="financialYears" placeholder="Select a Financial Year" optionLabel="name" [(ngModel)]="selectedFinancialYear" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}" appendTo="body" [disabled]="true"></p-dropdown>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </p-card>
        <div style="height: 10px;"></div>        
        <p-table [rowHover]="true" [value]="indicators" styleClass="p-datatable-sm" [columns]="scrollableCols" [frozenColumns]="frozenCols" [scrollable]="true" frozenWidth="75%">
            <ng-template pTemplate="frozencolgroup" let-columns>
                <colgroup>
                    <col style="width: 20%;">
                    <col style="width: 20%;">
                    <col style="width: 5%;">
                    <col style="width: 28%;">
                    <col style="width: 22%;">
                    <col style="width: 5%;">
                 
                </colgroup>
            </ng-template>
            <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                </colgroup>
            </ng-template>
            <ng-template pTemplate="frozenheader" let-columns>
                <tr style="border-bottom: hidden;">
                    <th style="text-align: center;">Programme</th>
                    <th style="text-align: center;">Sub Programme Type</th>
                    <th style="text-align: center;">IndicatorId</th>
                    <th style="text-align: center;">Indicator Description</th>
                    <th style="text-align: center;">Output Title</th>
                    <th style="text-align: center;">Year</th>
                </tr>
                <tr>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th colspan="2" style="text-align: center;">Quarter 1</th>
                    <th colspan="2" style="text-align: center;">Quarter 2</th>
                    <th colspan="2" style="text-align: center;">Quarter 3</th>
                    <th colspan="2" style="text-align: center;">Quarter 4</th>
                    <th colspan="2" style="text-align: center;">Total</th>
                </tr>
                <tr>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual YTD</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="frozenbody" let-rowData let-rowIndex="rowIndex">
                <tr class="default-font">
                    <td>{{programme}}</td>
                    <td>{{subprogramme}}</td>
                    <td>{{rowData.indicatorValue}}</td>
                    <td>{{rowData.indicatorDesc}}</td>
                    <td>{{rowData.outputTitle}}</td>
                    <td>{{rowData.year}}</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr class="default-font">

                <td style="text-align: center;">
                    <span >
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 1).totalTarget}}
                        </span>
                    </span>
                </td>
                <td style="text-align: center;">
                    <span>
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 1).totalActual}}
                        </span>
                    </span>
                </td>

                <td style="text-align: center;">
                    <span >
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 2).totalTarget}}
                        </span>
                    </span>
                </td>
                <td style="text-align: center;">
                    <span>
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 2).totalActual}}
                        </span>
                    </span>
                </td>

                <td style="text-align: center;">
                    <span >
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 3).totalTarget}}
                        </span>
                    </span>
                </td>
                <td style="text-align: center;">
                    <span>
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 3).totalActual}}
                        </span>
                    </span>
                </td>


                <td style="text-align: center;">
                    <span >
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 4).totalTarget}}
                        </span>
                    </span>
                </td>
                <td style="text-align: center;">
                    <span>
                        <span>
                            {{calculateTotalsPerQuarter(rowData.id, 4).totalActual}}
                        </span>
                    </span>
                </td>

                <td style="text-align: center;">
                    <span >
                        {{getTotalTargets(
                            calculateTotalsPerQuarter(rowData.id, 1).totalTarget,
                            calculateTotalsPerQuarter(rowData.id, 2).totalTarget,
                            calculateTotalsPerQuarter(rowData.id, 3).totalTarget,
                            calculateTotalsPerQuarter(rowData.id, 4).totalTarget
                        )}}
                    </span>
                </td>
                <td style="text-align: center;">
                    <span >
                        {{getTotalTargets(
                            calculateTotalsPerQuarter(rowData.id, 1).totalActual,
                            calculateTotalsPerQuarter(rowData.id, 2).totalActual,
                            calculateTotalsPerQuarter(rowData.id, 3).totalActual,
                            calculateTotalsPerQuarter(rowData.id, 4).totalActual
                        )}}
                    </span>
                </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr class="default-font">
                    <td colspan="28" style="text-align: center;">No results found</td>
                </tr>
            </ng-template>
        </p-table>
    </p-panel>
</p-panel>

