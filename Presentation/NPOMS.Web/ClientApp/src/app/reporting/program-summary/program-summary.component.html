<p-toast></p-toast>
<p-panel [toggleable]="false" [style]="{'font-size':'12px'}" header="Summary">
    <p-menubar [model]="menuActions" [style]="{'font-size':'14px'}"></p-menubar>    
    <div style="height: 10px;"></div>
    <p-panel [style]="{'font-size':'12px'}" header="Summary">
        <p-card [style]="{width: '100%',backgroundColor:'var(--surface-b)'}">
            <div style="margin-top: 0px;" class="p-grid">
                <div class="p-col-12">
                    <div class="p-fluid">
                        <div class="p-grid">
                            <!-- First Dropdown (Service Delivery Area) -->
                            <!-- <div class="p-col-6">
                                <div class="p-grid">
                                    <div class="p-col-fixed form-label">
                                        <div class="box">
                                            <span class="non-mandatory-content">Service Delivery Area</span>
                                        </div>
                                    </div>
                                    <div class="p-col">
                                        <p-dropdown
                                            [(ngModel)]="selectedOption"
                                            [options]="sdas"
                                            placeholder="Select service delivery area"
                                            optionLabel="name"
                                            (onChange)="onDropdownChange($event)">
                                        </p-dropdown>
                                    </div>
                                </div>
                            </div>
                             -->
                            <!-- Second Dropdown (Programme) -->
                            <div class="p-col-6">
                                <div class="p-grid">
                                    <div class="p-col-fixed form-label">
                                        <div class="box">
                                            <span class="non-mandatory-content">Programme</span>
                                        </div>
                                    </div>
                                    <div class="p-col">
                                        <p-dropdown
                                            [(ngModel)]="selectedProgramme"
                                            [options]="allProgrammes"
                                            placeholder="Select programme"
                                            optionLabel="name"
                                            (onChange)="onProgramDropdownChange($event)">
                                        </p-dropdown>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                        <div class="p-grid">
                            <!-- Third Dropdown (Sub Programme Types) -->

                            <div class="p-col-6">
                                <div class="p-grid">
                                    <div class="p-col-fixed form-label">
                                        <div class="box">
                                            <span class="non-mandatory-content"> Sub Programme Type</span>
                                        </div>
                                    </div>
                                    <div class="p-col">
                                        <p-dropdown [options]="filteredSubProgrammeTypes" placeholder="Select a Sub-Programme Type" optionLabel="name"
                                        [(ngModel)]="selectedSubProgrammeType" [ngModelOptions]="{standalone: true}" [style]="{'width':'100%'}"
                                         appendTo="body"  (onChange)="onSubprograDropdownChange($event)" #subProgrammeType="ngModel"
                                         appendTo="body" 
                                      ></p-dropdown>
                                    </div>
                                </div>
                            </div>
                           
                    
                            <!-- Fourth Dropdown (Indicator Value) -->
                            <!-- <div class="p-col-6">
                                <div class="p-grid">
                                    <div class="p-col-fixed form-label">
                                        <div class="box">
                                            <span class="non-mandatory-content">Indicator Value</span>
                                        </div>
                                    </div>
                                    <div class="p-col">
                                        <p-dropdown
                                            [(ngModel)]="selectedProgramme"
                                            [options]="allProgrammes"
                                            placeholder="Select indicator value"
                                            optionLabel="name"
                                            (onChange)="onProgramDropdownChange($event)">
                                        </p-dropdown>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    
                        <!-- Fifth Dropdown (Financial Year) -->
                        <div class="p-grid">
                            <div class="p-col-6">
                                <div class="p-grid">
                                    <div class="p-col-fixed form-label">
                                        <div class="box">
                                            <span class="mandatory-content">Financial Year</span>
                                        </div>
                                    </div>
                                    <div class="p-col">
                                        <p-dropdown
                                            [options]="financialYears"
                                            placeholder="Select a Financial Year"
                                            optionLabel="name"
                                            [(ngModel)]="selectedFinancialYear"
                                            (onChange)="onyearDropdownChange($event)"
                                            [ngModelOptions]="{standalone: true}"
                                            [style]="{'width':'100%'}"
                                            appendTo="body">
                                        </p-dropdown>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-grid">
                            <div class="p-col-6">
                                <div class="p-grid">
                                    <div class="p-col-fixed form-label">
                                        <div class="box">
                                            <span class="mandatory-content">Reset Filters</span>
                                        </div>
                                    </div>
                                    <div class="p-col">
                                        <button 
                                            pButton 
                                            type="button" 
                                            label="Reset" 
                                            class="p-button-outlined p-button-success"
                                            (click)="resetFilters()">
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
        </p-card>
        <div style="height: 10px;"></div>        
        <p-table [rowHover]="true" [value]="mergedList" styleClass="p-datatable-sm" [columns]="scrollableCols" [frozenColumns]="frozenCols" [scrollable]="true" frozenWidth="75%">
            <ng-template pTemplate="frozencolgroup" let-columns>
                <colgroup>
                    <col style="width: 10%;">
                    <col style="width: 27%;">
                    <col style="width: 20%;">
                    <col style="width: 20%;">
                    <col style="width: 9%;">
                    <col style="width: 18%;">
                    <col style="width: 5%;">
                </colgroup>
            </ng-template>
            <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                    <col style="width: 100px;">
                </colgroup>
            </ng-template>
            <ng-template pTemplate="frozenheader" let-columns>
                <tr style="border-bottom: hidden;">
                    <th style="text-align: center;">C-Code</th>
                    <th style="text-align: center;">Organisation Name</th>
                    <th style="text-align: center;">Programme</th>
                    <th style="text-align: center;">Sub Programme Type</th>
                    <th style="text-align: center;">IndicatorId</th>
                    <th style="text-align: center;">Indicator Description</th>
                    <th style="text-align: center;">Year</th>
                </tr>
                <tr>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                    <th style="text-align: center;">&nbsp;</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th colspan="2" style="text-align: center;">Quarter 1</th>
                    <th colspan="2" style="text-align: center;">Quarter 2</th>
                    <th colspan="2" style="text-align: center;">Quarter 3</th>
                    <th colspan="2" style="text-align: center;">Quarter 4</th>
                    <th colspan="2" style="text-align: center;">Total</th>
                </tr>
                <tr>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual</th>
                    <th colspan="1" style="text-align: center;">Target</th>
                    <th colspan="1" style="text-align: center;">Actual YTD</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="frozenbody" let-rowData let-rowIndex="rowIndex">
                <tr class="default-font">
                    <td>{{rowData.ccode}}</td>
                    <td>{{rowData.organisationName}}</td>
                    <td>{{rowData.programme}}</td>
                    <td>{{rowData.subprogrammeType}}</td>
                    <td>{{rowData.indicatorValue}}</td>
                    <td>{{rowData.outputTitle}}</td>
                    <td>{{rowData.year}}</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr class="default-font">
<!-- 
                <td style="text-align: center;">
                    <span >
                        <span *ngIf="rowData.qaurterId ==1">
                            {{rowData.targets}}
                        </span>
                    </span>
                </td>
                <td style="text-align: center;">
                    <span>
                        <span *ngIf="rowData.qaurterId ==1">
                            {{rowData.actual}}
                        </span>
                    </span>
                </td>

                <td style="text-align: center;">
                    <span >
                        <span *ngIf="rowData.qaurterId ==2">
                            {{rowData.targets}}
                        </span>
                    </span>
                </td>
                <td style="text-align: center;">
                    <span>
                        <span *ngIf="rowData.qaurterId ==2">
                            {{rowData.actual}}
                        </span>
                    </span>
                </td>

                <td style="text-align: center;">
                    <span >
                        <span *ngIf="rowData.qaurterId ==3">
                            {{rowData.targets}}
                        </span>
                    </span>
                </td>
                
                <td style="text-align: center;">
                    <span>
                        <span *ngIf="rowData.qaurterId ==3">
                            {{rowData.actual}}
                        </span>
                    </span>
                </td>

                <td style="text-align: center;">
                    <span >
                        <span *ngIf="rowData.qaurterId ==4">
                            {{rowData.targets}}
                        </span>
                    </span>
                </td>

                <td style="text-align: center;">
                    <span>
                        <span *ngIf="rowData.qaurterId ==4">
                            {{rowData.actual}}
                        </span>
                    </span>
                </td> -->
                <!-- Quarter 1 -->
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[0]?.QuarterId === 1">
                    {{ rowData.quarters[0]?.Targets }}
                    </span>
                </td>
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[0]?.QuarterId === 1">
                    {{ rowData.quarters[0]?.Actual }}
                    </span>
                </td>

                <!-- Quarter 2 -->
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[1]?.QuarterId === 2">
                    {{ rowData.quarters[1]?.Targets }}
                    </span>
                </td>
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[1]?.QuarterId === 2">
                    {{ rowData.quarters[1]?.Actual }}
                    </span>
                </td>

                <!-- Quarter 3 -->
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[2]?.QuarterId === 3">
                    {{ rowData.quarters[2]?.Targets }}
                    </span>
                </td>
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[2]?.QuarterId === 3">
                    {{ rowData.quarters[2]?.Actual }}
                    </span>
                </td>

                <!-- Quarter 4 -->
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[3]?.QuarterId === 4">
                    {{ rowData.quarters[3]?.Targets }}
                    </span>
                </td>
                <td style="text-align: center;">
                    <span *ngIf="rowData.quarters[3]?.QuarterId === 4">
                    {{ rowData.quarters[3]?.Actual }}
                    </span>
                </td>

                <td style="text-align: center;">
                    <span >
                        {{getTotalTargets(rowData)}}
                    </span>
                </td>
                <td style="text-align: center;">
                    <span >
                        {{getTotalActuals(rowData)}}
                    </span>
                </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr class="default-font">
                    <td colspan="28" style="text-align: center;">No results found</td>
                </tr>
            </ng-template>
        </p-table>
    </p-panel>
</p-panel>
